<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>register</title>
        <link href="style.css" rel="stylesheet">
    </head>
    <body class="column">
    <h2>FILES</h2>
    <div class="documents">
        <div class="box">
            <input type="file" class="subfile" name="markdown" id="markdown" onchange="changeMarkdownText('markdown')" accept=".md">
            <div class="form">
                <svg fill="#b8b9bf" xmlns="http://www.w3.org/2000/svg" width="10" height="7" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"></path></svg>
            </div>
            <label class="text" for="markdown"><span id="file-markdown">Choose markdown file…</span></label>
        </div>

        <div class="box">
            <input type="file" class="subfile" name="style" id="style" onchange="changeMarkdownText('style')" accept=".css">
            <div class="form">
                <svg fill="#b8b9bf" xmlns="http://www.w3.org/2000/svg" width="10" height="7" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"></path></svg>
            </div>
            <label class="text" for="style"><span id="file-style">Choose style file…</span></label>
        </div>

        <div class="box">
            <input type="file" class="subfile" webkitdirectory name="assets" id="assets" onchange="changeMarkdownText('assets')" accept="assets">
            <div class="form">
                <svg fill="#b8b9bf" xmlns="http://www.w3.org/2000/svg" width="10" height="7" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"></path></svg>
            </div>
            <label class="text" for="assets"><span id="directory-assets">Choose assets directory…</span></label>
        </div>

        <div class="box">
            <input type="file" class="subfile" webkitdirectory name="env" id="env" onchange="changeMarkdownText('env')" accept="env">
            <div class="form">
                <svg fill="#b8b9bf" xmlns="http://www.w3.org/2000/svg" width="10" height="7" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"></path></svg>
            </div>
            <label class="text" for="env"><span id="directory-env">Choose env directory…</span></label>
        </div>
    </div>
    <h2>CONFIG</h2>
    <div class="documents">
        <div class="columnInput">
            <label class="text">title</label>
            <input class="textInput" id="title">
        </div>
        <div class="columnInput">
            <label  class="text">auteurs (séparer par des ';')</label>
            <input class="textInput" id="authors">
        </div>
        <div class="columnInput">
            <label class="text">durée (en min)</label>
            <input class="textInput" id="duration" type="number">
        </div>
    </div>
    <button class="save" id="submit">Enregistrer sous</button>
    </body>

<script>
let markdown;
let style;
let assets;
let env;
let title;
let authors;
let duration;

const changeMarkdownText = (name) => {
    let fileMarkdown = document.getElementById('file-markdown')
    let fileStyle = document.getElementById('file-style')
    let directoryAssets = document.getElementById('directory-assets')
    let directoryEnv = document.getElementById('directory-env')

    switch (name) {
        case 'markdown' :
            fileMarkdown.innerText = markdown.files[0].name
            break
        case 'style' :
            fileStyle.innerText = style.files[0].name
            break
        case 'assets' :
            directoryAssets.innerText = `${assets.files.length} files `
            break
        case 'env' :
            directoryEnv.innerText = `${env.files.length} files `
            break
    }

}

const sendInfo = () => {
    if(markdown.files.length > 0 && style.files.length > 0 && assets.files.length > 0 && env.files.length > 0 && title.value !== "" && authors.value !== "" && duration.value !== "") {
        const assetsFiles = [];
        for(let i = 0; i < assets.files.length; i++) {
            assetsFiles.push(assets.files[i].path);
        }

        const envFiles = [];
        for(let i = 0; i < env.files.length; i++) {
            envFiles.push(env.files[i].path);
        }

        const data = {
        "markdown": markdown.files[0].path,
        "style": style.files[0].path,
        "assets": assetsFiles,
        "env": envFiles,
        "title": title.value,
        "authors": authors.value,
        "duration": duration.value,
        };

        window.api.send("save", data);
    } else {
        alert("Veuillez remplir tous les champs");
    }
}

window.onload = () => {
    markdown = document.getElementById("markdown");
    style = document.getElementById("style");
    assets = document.getElementById("assets");
    env = document.getElementById("env");
    title = document.getElementById("title");
    authors = document.getElementById("authors");
    duration = document.getElementById("duration");
    let submit = document.getElementById("submit");

    submit.addEventListener("click", sendInfo);
}

</script>
</html>